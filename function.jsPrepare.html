{if $theme_settings.jquery_delayed_loading && !waRequest::isXMLHttpRequest()}
    {$match = null}
    {if preg_match_all("/<script[^>]*>(.*?)<\/script>/si", $content, $matchs)}
        {foreach $matchs[1] as $index => $match}               
            {if strpos($matchs[0][$index], 'data-disable-delayed-loading') === false}
                {if trim($match)}
                    {$json = json_encode($match)}
                    {$content = str_replace($matchs[0][$index], "<script type=\"text/javascript\">window.delayJsFunctions.push($json);</script>", $content)}
                {elseif preg_match("/<script.+?src\s*=\s*[\"'](.+?)[\"'].*?>.*?<\/script>/si",$matchs[0][$index], $src)}
                    {$src_url = $src[1]}
                    {$content = str_replace($matchs[0][$index], "<script type=\"text/javascript\">window.delayJs.push(\"$src_url\");</script>", $content)}
                {/if}
            {/if}
        {/foreach}
    {/if}
    {$content}
{else}
    {$content}
{/if}